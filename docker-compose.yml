version: '3.9'
networks:
  default:
    external: true
    name: bcms
services:
  proxy:
    container_name: bcms-proxy_ui
    image: 'becomes/cms-proxy-local:1.0.7'
    ports:
      - '8080:8080'
    logging:
      driver: none
  shim:
    container_name: bcms-shim_ui
    depends_on:
      - proxy
    image: 'becomes/cms-shim-local:1.0.5'
    ports:
      - '1279:1279'
    logging:
      driver: none
  backend:
    container_name: bcms-backend_ui
    depends_on:
      - shim
    image: 'becomes/cms-backend-local:1.0.32'
    ports:
      - '1280:8080'
    # logging:
    #   driver: none
    volumes:
      - type: bind
        source: ./bcms.config.js
        target: /app/bcms.config.js
      - type: bind
        source: ./shim.json
        target: /app/shim.json
      - type: bind
        source: ./db
        target: /app/db
      - type: bind
        source: ./uploads
        target: /app/uploads
  ui:
    container_name: bcms-ui_ui
    depends_on:
      - backend
    build:
      context: ''
      dockerfile: Dockerfile.dev
    ports:
      - '1281:1281'
    logging:
      driver: none
    volumes:
      - type: bind
        source: ./public
        target: /app/public
      - type: bind
        source: ./src
        target: /app/src
      - type: bind
        source: ./tailwind.config.cjs
        target: /app/tailwind.config.cjs
      - type: bind
        source: ./postcss.config.cjs
        target: /app/postcss.config.cjs
      - type: bind
        source: ./vite.config.ts
        target: /app/vite.config.ts
